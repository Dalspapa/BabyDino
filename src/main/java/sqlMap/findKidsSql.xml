<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dino.findKids">

	<insert id="t_makeCard" parameterType="dino.Dto.MakeTCardDto">
		<selectKey keyProperty="idx" resultType="int" order="BEFORE">
			SELECT  d_teacher_idx.NEXTVAL FROM DUAL
		</selectKey>
		insert into
			d_teacher
		values(
			#{idx},
			42,
			#{job},
			'1',
			#{kid_type},
			#{t_care_type},
			#{schedule_day},
			#{schedule_time},
			#{t_cost},
			#{t_introduce},
			#{bank},
			#{acnum},
			#{cctvagree},
			'signclear',
			#{career_experience}
		)		
	</insert>
	
	<select id="kidsList" resultType="dino.Dto.MakeTCardDto">
		select
			*
		from 
			d_kid
		order by idx desc
	</select>
	
	<select id="getTIdx" parameterType="Integer" resultType="Integer">
		select 
			idx 
		from 
			(select * from d_teacher order by idx desc) 
		where 
			rownum = 1 and d_member_idx = #{d_member_idx};
	</select>
	
	<insert id="tSetImg" parameterType="dino.Dto.Common_ImgDto">
		INSERT INTO
			d_common_img
		VALUES(
			d_common_img_idx.nextval,
			#{c_imgpath},
			#{d_member_idx},
			2,
			#{ref_idx}
		)
	</insert>
	
	<select id="getImg" parameterType="Integer" resultType="dino.Dto.Common_ImgDto" >
	    SELECT 
	        dt.*, dci.c_imgpath
	    FROM 
	        d_teacher dt 
	    LEFT JOIN 
	        d_common_img dci 
	    ON 
	        dt.d_member_idx = dci.d_member_idx
	    WHERE
	        dt.d_member_idx = #{d_member_idx}
	</select>
	
</mapper>













